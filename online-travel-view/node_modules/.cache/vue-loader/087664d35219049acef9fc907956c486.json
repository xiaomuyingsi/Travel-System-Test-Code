{"remainingRequest":"F:\\Java\\Code\\online-travel-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Java\\Code\\online-travel-view\\src\\views\\admin\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\Java\\Code\\online-travel-view\\src\\views\\admin\\Home.vue","mtime":1744255511522},{"path":"F:\\Java\\Code\\online-travel-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Java\\Code\\online-travel-view\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\Java\\Code\\online-travel-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Java\\Code\\online-travel-view\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCByZXF1ZXN0IGZyb20gIkAvdXRpbHMvcmVxdWVzdC5qcyI7CmltcG9ydCByb3V0ZXIgZnJvbSAiQC9yb3V0ZXIvaW5kZXgiOwppbXBvcnQgeyBjbGVhclRva2VuIH0gZnJvbSAiQC91dGlscy9zdG9yYWdlIgppbXBvcnQgQWRtaW5NZW51IGZyb20gJ0AvY29tcG9uZW50cy9WZXJ0aWNhbE1lbnUudnVlJzsKaW1wb3J0IExvZ28gZnJvbSAnQC9jb21wb25lbnRzL0xvZ28udnVlJzsKaW1wb3J0IExldmVsSGVhZGVyIGZyb20gJ0AvY29tcG9uZW50cy9MZXZlbEhlYWRlci52dWUnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkFkbWluIiwKICBjb21wb25lbnRzOiB7CiAgICBMb2dvLAogICAgTGV2ZWxIZWFkZXIsCiAgICBBZG1pbk1lbnUKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhZG1pblJvdXRlczogW10sCiAgICAgIGFjdGl2ZUluZGV4OiAnJywKICAgICAgdXNlckluZm86IHsKICAgICAgICBpZDogbnVsbCwKICAgICAgICB1cmw6ICcnLAogICAgICAgIG5hbWU6ICcnLAogICAgICAgIHJvbGU6IG51bGwsCiAgICAgICAgZW1haWw6ICcnCiAgICAgIH0sCiAgICAgIGZsYWc6IGZhbHNlLAogICAgICB0YWc6ICflj6/op4bljJYnLAogICAgICBiYWc6ICdyZ2IoMjU1IDI1NSAyNTUpJywKICAgICAgY29sb3JMb2dvOiAncmdiKDUxLDUxLDUxKScsCiAgICAgIGJhZ01lbnU6ICdyZ2IoMjU1IDI1NSAyNTUpJywKICAgICAgZGlhbG9nT3BlcmFpb246IGZhbHNlCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIGxldCBtZW51cyA9IHJvdXRlci5vcHRpb25zLnJvdXRlcy5maWx0ZXIocm91dGUgPT4gcm91dGUucGF0aCA9PSAnL2FkbWluJylbMF07CiAgICB0aGlzLmFkbWluUm91dGVzID0gbWVudXMuY2hpbGRyZW47CiAgICB0aGlzLnRva2VuQ2hlY2tMb2FkKCk7CiAgICB0aGlzLm1lbnVPcGVyYXRpb25IaXN0b3J5KCk7CiAgfSwKCiAgbWV0aG9kczogewogICAgYXN5bmMgdXBkYXRlVXNlckluZm8oKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgdXNlclVwZGF0ZURUTyA9IHsKICAgICAgICAgIHVzZXJBdmF0YXI6IHRoaXMudXNlckluZm8udXJsLAogICAgICAgICAgdXNlck5hbWU6IHRoaXMudXNlckluZm8ubmFtZSwKICAgICAgICAgIHVzZXJFbWFpbDogdGhpcy51c2VySW5mby5lbWFpbAogICAgICAgIH0KICAgICAgICBjb25zdCByZXNwb3NuZSA9IGF3YWl0IHRoaXMuJGF4aW9zLnB1dChgL3VzZXIvdXBkYXRlYCwgdXNlclVwZGF0ZURUTyk7CiAgICAgICAgY29uc3QgeyBkYXRhIH0gPSByZXNwb3NuZTsKICAgICAgICBpZiAoZGF0YS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuZGlhbG9nT3BlcmFpb24gPSBmYWxzZTsKICAgICAgICAgIHRoaXMudG9rZW5DaGVja0xvYWQoKTsKICAgICAgICAgIHRoaXMuJHN3YWwuZmlyZSh7CiAgICAgICAgICAgIHRpdGxlOiAn5L+u5pS55Liq5Lq65L+h5oGvJywKICAgICAgICAgICAgdGV4dDogZGF0YS5tc2csCiAgICAgICAgICAgIGljb246ICdzdWNjZXNzJywKICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICB0aW1lcjogMTAwMCwKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRoaXMuZGlhbG9nT3BlcmFpb24gPSBmYWxzZTsKICAgICAgICB0aGlzLiRzd2FsLmZpcmUoewogICAgICAgICAgdGl0bGU6ICfkv67mlLnkuKrkurrkv6Hmga/lvILluLgnLAogICAgICAgICAgdGV4dDogZSwKICAgICAgICAgIGljb246ICdlcnJvcicsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICB0aW1lcjogMjAwMCwKICAgICAgICB9KTsKICAgICAgICBjb25zb2xlLmVycm9yKGDkv67mlLnkuKrkurrkv6Hmga/lvILluLg6JHtlfWApOwogICAgICB9CiAgICB9LAogICAgaGFuZGxlQXZhdGFyU3VjY2VzcyhyZXMsIGZpbGUpIHsKICAgICAgaWYgKHJlcy5jb2RlICE9PSAyMDApIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKGDlpLTlg4/kuIrkvKDlvILluLhgKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKGDlpLTlg4/kuIrkvKDmiJDlip9gKTsKICAgICAgdGhpcy51c2VySW5mby51cmwgPSByZXMuZGF0YTsKICAgIH0sCiAgICBldmVudExpc3RlbmVyKGV2ZW50KSB7CiAgICAgIC8vIOS4quS6uuS4reW/gwogICAgICBpZiAoZXZlbnQgPT09ICdjZW50ZXInKSB7CiAgICAgICAgdGhpcy5kaWFsb2dPcGVyYWlvbiA9IHRydWU7CiAgICAgIH0KICAgICAgLy8g6YCA5Ye655m75b2VCiAgICAgIGlmIChldmVudCA9PT0gJ2xvZ2luT3V0JykgewogICAgICAgIHRoaXMubG9naW5PdXQoKTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGxvZ2luT3V0KCl7CiAgICAgIGNvbnN0IGNvbmZpcm1lZCA9IGF3YWl0IHRoaXMuJHN3YWxDb25maXJtKHsKICAgICAgICB0aXRsZTogJ+mAgOWHuueZu+W9le+8nycsCiAgICAgICAgdGV4dDogYOaOqOWHuuWQjumcgOmHjeaWsOeZu+W9le+8n2AsCiAgICAgICAgaWNvbjogJ3dhcm5pbmcnLAogICAgICB9KTsKICAgICAgaWYgKGNvbmZpcm1lZCkgewogICAgICAgIHRoaXMuJHN3YWwuZmlyZSh7CiAgICAgICAgICB0aXRsZTogJ+mAgOWHuueZu+W9leaIkOWKnycsCiAgICAgICAgICB0ZXh0OiAnMXMg5ZCO6L+U5Zue55m75b2V6aG16Z2iJywKICAgICAgICAgIGljb246ICdzdWNjZXNzJywKICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgIHRpbWVyOiAxMDAwLAogICAgICAgIH0pOwogICAgICAgIHNldFRpbWVvdXQoKCk9PnsKICAgICAgICAgIGNsZWFyVG9rZW4oKTsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvbG9naW4iKTsKICAgICAgICB9LDEwMDApCiAgICAgIH0KICAgIH0sCiAgICBtZW51T3BlcmF0aW9uSGlzdG9yeSgpIHsKICAgICAgdGhpcy5mbGFnID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnZmxhZycpID09PSAndHJ1ZSc7CiAgICB9LAogICAgc2VsZWN0T3BlcmF0aW9uKGZsYWcpIHsKICAgICAgdGhpcy5mbGFnID0gZmxhZzsKICAgIH0sCiAgICBoYW5kbGVSb3V0ZVNlbGVjdChpbmRleCkgewogICAgICBsZXQgYXJ5ID0gdGhpcy5hZG1pblJvdXRlcy5maWx0ZXIoZW50aXR5ID0+IGVudGl0eS5wYXRoID09IGluZGV4KTsKICAgICAgdGhpcy50YWcgPSBhcnlbMF0ubmFtZTsKICAgICAgaWYgKHRoaXMuJHJvdXRlci5jdXJyZW50Um91dGUuZnVsbFBhdGggPT0gaW5kZXgpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goaW5kZXgpOwogICAgfSwKICAgIC8vIFRva2Vu5qOA6aqMCiAgICBhc3luYyB0b2tlbkNoZWNrTG9hZCgpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0LmdldCgndXNlci9hdXRoJyk7CiAgICAgICAgLy8g6ZSZ6K+v5aSE55CGCiAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDQwMCkgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMuZGF0YS5tc2cpOwogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9sb2dpbicpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAvLyDnlKjmiLfkv6Hmga/otYvlgLwKICAgICAgICBjb25zdCB7IGlkLCB1c2VyQXZhdGFyOiB1cmwsIHVzZXJOYW1lOiBuYW1lLCB1c2VyUm9sZTogcm9sZSwgdXNlckVtYWlsOiBlbWFpbCB9ID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICB0aGlzLnVzZXJJbmZvID0geyBpZCwgdXJsLCBuYW1lLCByb2xlLCBlbWFpbCB9OwogICAgICAgIC8vIOagueaNruinkuiJsuino+aekOi3r+eUsQogICAgICAgIGNvbnN0IHJvbGVQYXRoID0gcm9sZSA9PT0gMSA/ICcvYWRtaW4nIDogJy91c2VyJzsKICAgICAgICBjb25zdCB0YXJnZXRNZW51ID0gcm91dGVyLm9wdGlvbnMucm91dGVzLmZpbmQocm91dGUgPT4gcm91dGUucGF0aCA9PT0gcm9sZVBhdGgpOwogICAgICAgIGlmICh0YXJnZXRNZW51KSB7CiAgICAgICAgICB0aGlzLnJvdXRlcnMgPSB0YXJnZXRNZW51LmNoaWxkcmVuOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLndhcm4oYOacquaJvuWIsOS4juinkuiJsuWvueW6lOeahOi3r+eUse+8miR7cm9sZVBhdGh9YCk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPlueUqOaIt+iupOivgeS/oeaBr+aXtuWPkeeUn+mUmeivrzonLCBlcnJvcik7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6K6k6K+B5L+h5oGv5Yqg6L295aSx6LSl77yM6K+36YeN6K+V77yBJyk7CiAgICAgIH0KICAgIH0sCiAgfQp9Owo="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views/admin","sourcesContent":["<template>\n  <div class=\"menu-container\">\n    <div class=\"menu-side\" :class=\"{ 'menu-side-narrow': flag }\">\n      <div style=\"display: flex;align-items: center;\">\n        <Logo sysName=\"旅游后台\" style=\"padding: 0 40px;margin: 10px 0;\" :flag=\"flag\" :bag=\"colorLogo\" />\n      </div>\n      <div style=\"margin-top: 12px;\">\n        <AdminMenu :flag=\"flag\" :routes=\"adminRoutes\" :bag=\"bagMenu\" @select=\"handleRouteSelect\" />\n      </div>\n    </div>\n    <div class=\"main\">\n      <div class=\"header-section\">\n        <LevelHeader @eventListener=\"eventListener\" @selectOperation=\"selectOperation\" :tag=\"tag\"\n                     :userInfo=\"userInfo\" />\n      </div>\n      <div class=\"content-section\">\n        <router-view></router-view>\n      </div>\n    </div>\n    <!-- 个人中心 -->\n    <el-dialog :show-close=\"false\" :visible.sync=\"dialogOperaion\" width=\"26%\">\n      <div slot=\"title\" style=\"padding: 25px 0 0 20px;\">\n        <span style=\"font-size: 18px;font-weight: 800;\">个人中心</span>\n      </div>\n      <el-row style=\"padding: 10px 20px 20px 20px;\">\n        <el-row>\n          <p style=\"font-size: 12px;padding: 3px 0;margin-bottom: 10px;\">\n            <span class=\"modelName\">*头像</span>\n          </p>\n          <el-upload class=\"avatar-uploader\" action=\"/api/online-travel-sys/v1.0/file/upload\"\n                     :show-file-list=\"false\" :on-success=\"handleAvatarSuccess\">\n            <img v-if=\"userInfo.url\" :src=\"userInfo.url\" style=\"width: 80px;height: 80px;\">\n            <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n          </el-upload>\n        </el-row>\n        <el-row>\n          <p style=\"font-size: 12px;padding: 3px 0;\">\n            <span class=\"modelName\">*用户名</span>\n          </p>\n          <input class=\"input-title\" v-model=\"userInfo.name\" placeholder=\"用户名\">\n        </el-row>\n        <el-row>\n          <p style=\"font-size: 12px;padding: 3px 0;\">\n            <span class=\"modelName\">*用户邮箱</span>\n          </p>\n          <input class=\"input-title\" v-model=\"userInfo.email\" placeholder=\"用户邮箱\">\n        </el-row>\n      </el-row>\n      <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button class=\"customer\" size=\"small\" style=\"background-color: rgb(241, 241, 241);border: none;\"\n                           @click=\"dialogOperaion = false\">取 消</el-button>\n                <el-button size=\"small\" style=\"background-color: #15559a;border: none;\" class=\"customer\" type=\"info\"\n                           @click=\"updateUserInfo\">修改</el-button>\n            </span>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport request from \"@/utils/request.js\";\nimport router from \"@/router/index\";\nimport { clearToken } from \"@/utils/storage\"\nimport AdminMenu from '@/components/VerticalMenu.vue';\nimport Logo from '@/components/Logo.vue';\nimport LevelHeader from '@/components/LevelHeader.vue';\nexport default {\n  name: \"Admin\",\n  components: {\n    Logo,\n    LevelHeader,\n    AdminMenu\n  },\n  data() {\n    return {\n      adminRoutes: [],\n      activeIndex: '',\n      userInfo: {\n        id: null,\n        url: '',\n        name: '',\n        role: null,\n        email: ''\n      },\n      flag: false,\n      tag: '可视化',\n      bag: 'rgb(255 255 255)',\n      colorLogo: 'rgb(51,51,51)',\n      bagMenu: 'rgb(255 255 255)',\n      dialogOperaion: false\n    };\n  },\n  created() {\n    let menus = router.options.routes.filter(route => route.path == '/admin')[0];\n    this.adminRoutes = menus.children;\n    this.tokenCheckLoad();\n    this.menuOperationHistory();\n  },\n\n  methods: {\n    async updateUserInfo() {\n      try {\n        const userUpdateDTO = {\n          userAvatar: this.userInfo.url,\n          userName: this.userInfo.name,\n          userEmail: this.userInfo.email\n        }\n        const resposne = await this.$axios.put(`/user/update`, userUpdateDTO);\n        const { data } = resposne;\n        if (data.code === 200) {\n          this.dialogOperaion = false;\n          this.tokenCheckLoad();\n          this.$swal.fire({\n            title: '修改个人信息',\n            text: data.msg,\n            icon: 'success',\n            showConfirmButton: false,\n            timer: 1000,\n          });\n        }\n      } catch (e) {\n        this.dialogOperaion = false;\n        this.$swal.fire({\n          title: '修改个人信息异常',\n          text: e,\n          icon: 'error',\n          showConfirmButton: false,\n          timer: 2000,\n        });\n        console.error(`修改个人信息异常:${e}`);\n      }\n    },\n    handleAvatarSuccess(res, file) {\n      if (res.code !== 200) {\n        this.$message.error(`头像上传异常`);\n        return;\n      }\n      this.$message.success(`头像上传成功`);\n      this.userInfo.url = res.data;\n    },\n    eventListener(event) {\n      // 个人中心\n      if (event === 'center') {\n        this.dialogOperaion = true;\n      }\n      // 退出登录\n      if (event === 'loginOut') {\n        this.loginOut();\n      }\n    },\n    async loginOut(){\n      const confirmed = await this.$swalConfirm({\n        title: '退出登录？',\n        text: `推出后需重新登录？`,\n        icon: 'warning',\n      });\n      if (confirmed) {\n        this.$swal.fire({\n          title: '退出登录成功',\n          text: '1s 后返回登录页面',\n          icon: 'success',\n          showConfirmButton: false,\n          timer: 1000,\n        });\n        setTimeout(()=>{\n          clearToken();\n          this.$router.push(\"/login\");\n        },1000)\n      }\n    },\n    menuOperationHistory() {\n      this.flag = sessionStorage.getItem('flag') === 'true';\n    },\n    selectOperation(flag) {\n      this.flag = flag;\n    },\n    handleRouteSelect(index) {\n      let ary = this.adminRoutes.filter(entity => entity.path == index);\n      this.tag = ary[0].name;\n      if (this.$router.currentRoute.fullPath == index) {\n        return;\n      }\n      this.$router.push(index);\n    },\n    // Token检验\n    async tokenCheckLoad() {\n      try {\n        const res = await request.get('user/auth');\n        // 错误处理\n        if (res.data.code === 400) {\n          this.$message.error(res.data.msg);\n          this.$router.push('/login');\n          return;\n        }\n        // 用户信息赋值\n        const { id, userAvatar: url, userName: name, userRole: role, userEmail: email } = res.data.data;\n        this.userInfo = { id, url, name, role, email };\n        // 根据角色解析路由\n        const rolePath = role === 1 ? '/admin' : '/user';\n        const targetMenu = router.options.routes.find(route => route.path === rolePath);\n        if (targetMenu) {\n          this.routers = targetMenu.children;\n        } else {\n          console.warn(`未找到与角色对应的路由：${rolePath}`);\n        }\n      } catch (error) {\n        console.error('获取用户认证信息时发生错误:', error);\n        this.$message.error('认证信息加载失败，请重试！');\n      }\n    },\n  }\n};\n</script>\n<style scoped lang=\"scss\">\n.menu-container {\n  display: flex;\n  height: 100vh;\n  width: 100%;\n\n\n  .menu-side {\n    width: 253px;\n    min-width: 115px;\n    height: 100vh;\n    padding-top: 10px;\n    box-sizing: border-box;\n    transition: width 0.3s ease;\n    background-color: rgb(255 255 255);\n    border-right: 1px solid rgb(240, 240, 240);\n  }\n\n  .menu-side-narrow {\n    width: 115px;\n  }\n\n  .main {\n    flex-grow: 1;\n    overflow-x: hidden;\n    .header-section {\n      max-width: 100%;\n      padding: 0 15px;\n    }\n\n    .content-section {\n      flex-grow: 1;\n      padding: 5px;\n      overflow-y: auto;\n    }\n  }\n\n\n\n}\n</style>"]}]}