{"remainingRequest":"F:\\Java\\Code\\online-travel-view\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Java\\Code\\online-travel-view\\src\\views\\user\\ScenicDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\Java\\Code\\online-travel-view\\src\\views\\user\\ScenicDetail.vue","mtime":1744887351409},{"path":"F:\\Java\\Code\\online-travel-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Java\\Code\\online-travel-view\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"F:\\Java\\Code\\online-travel-view\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\Java\\Code\\online-travel-view\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyB0aW1lQWdvIH0gZnJvbSAiQC91dGlscy9kYXRhIg0KaW1wb3J0IEV2YWx1YXRpb25zIGZyb20gIkAvY29tcG9uZW50cy9FdmFsdWF0aW9ucyINCmV4cG9ydCBkZWZhdWx0IHsNCiAgY29tcG9uZW50czogeyBFdmFsdWF0aW9ucyB9LA0KICBuYW1lOiAiU2NlbmljRGV0YWlsIiwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgZGF0YTogeyBidXlOdW1iZXI6IDEgfSwgLy8g5a2Y5YKo6LSt56Wo55u45YWz55qE5L+h5oGvDQogICAgICBzY2VuaWM6IHt9LA0KICAgICAgdGlja2V0OiB7fSwNCiAgICAgIHNjZW5pY1JhdGluZzoge30sDQogICAgICBteVNjb3JlOiAwLA0KICAgICAgc2NlbmljUmF0aW5nTGlzdDogW10sDQogICAgICBzY2VuaWNUaWNrZXRMaXN0OiBbXSwNCiAgICAgIHNjZW5pY0xpbmVMaXN0OiBbXSwNCiAgICAgIGRpYWxvZ1RpY2tldE9wZXJhaW9uOiBmYWxzZSwNCiAgICAgIGFjdGl2ZU5hbWU6ICdmaXJzdCcsDQogICAgICByYXRpbmdGbGFnOiBmYWxzZSwNCiAgICAgIHNhdmVCdG5GbGFnOiBmYWxzZSwNCiAgICB9DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5sb2FkSW5mbygpOw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy8g5p+l6K+i5pmv54K56Lev57q/DQogICAgcXVlcnlMaW5lKGlkKSB7DQogICAgICB0aGlzLiRheGlvcy5wb3N0KCcvc2NlbmljTGluZS9xdWVyeScsIHsgc2NlbmljSWQ6IGlkIH0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDIwMCkgew0KICAgICAgICAgIHRoaXMuc2NlbmljTGluZUxpc3QgPSByZXMuZGF0YS5kYXRhOw0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g6LSt56WoDQogICAgYWRkT3BlcmF0aW9uKCkgew0KICAgICAgdGhpcy5kYXRhLnRpY2tldElkID0gdGhpcy50aWNrZXQuaWQ7DQogICAgICB0aGlzLiRheGlvcy5wb3N0KCcvc2NlbmljVGlja2V0T3JkZXIvc2F2ZScsIHRoaXMuZGF0YSkudGhlbihyZXMgPT4gew0KICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PT0gMjAwKSB7IC8vIOS4i+WNleaIkOWKnw0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXMuZGF0YS5tc2cpOw0KICAgICAgICAgIHRoaXMuZGlhbG9nVGlja2V0T3BlcmFpb24gPSBmYWxzZTsNCiAgICAgICAgICAvLyDot7PliLDlr7nlupTnmoTpl6jnpajorqLljZXpobUNCiAgICAgICAgICBjb25zb2xlLmxvZygi5LiL5Y2V5LqG44CC6Lez6L2s6K6i5Y2V6aG1Iik7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMuZGF0YS5tc2cpOw0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g57uf6K6h6YeR6aKdDQogICAgbW9uZXlDb3VudChkYXRhKSB7DQogICAgICAvLyDlj6/og73msqHmnInmipjmiaMNCiAgICAgIGNvbnN0IGRpc2NvdW50VG90YWwgPSB0aGlzLnRpY2tldC5kaXNjb3VudCA9PT0gbnVsbCA/IDEgOiAodGhpcy50aWNrZXQuZGlzY291bnQgLyAxMCk7DQogICAgICBjb25zdCB0b3RhbCA9IGRhdGEuYnV5TnVtYmVyICogdGhpcy50aWNrZXQucHJpY2UgKiBkaXNjb3VudFRvdGFsOw0KICAgICAgLy8g5L2/55SoIE1hdGguY2VpbCDlj5bmlbTvvIznhLblkI7kv53nlZnkuKTkvY3lsI/mlbANCiAgICAgIHJldHVybiBNYXRoLmNlaWwodG90YWwgKiAxMDApIC8gMTAwOw0KICAgIH0sDQogICAgLy8g5Y+W5raI6LSt56WoDQogICAgY2FubmVsKCkgew0KICAgICAgLy8g5YWz6Zet6LSt56Wo5by556qXDQogICAgICB0aGlzLmRpYWxvZ1RpY2tldE9wZXJhaW9uID0gZmFsc2U7DQogICAgICB0aGlzLmRhdGEgPSB7fTsNCiAgICB9LA0KICAgIGJ1eVRpY2tldERpYWxvZyh0aWNrZXQpIHsNCiAgICAgIHRoaXMudGlja2V0ID0gdGlja2V0Ow0KICAgICAgdGhpcy5kaWFsb2dUaWNrZXRPcGVyYWlvbiA9IHRydWU7DQogICAgfSwNCiAgICAvLyDmlLbol4/mk43kvZwNCiAgICBzYXZlT3BlcmF0aW9uKCkgew0KICAgICAgdGhpcy4kYXhpb3MucG9zdChgL3NjZW5pYy9zYXZlT3BlcmF0aW9uLyR7dGhpcy5zY2VuaWMuaWR9YCkudGhlbihyZXMgPT4gew0KICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PT0gMjAwKSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlcy5kYXRhLm1zZyk7DQogICAgICAgICAgdGhpcy5zYXZlU3RhdHVzKCk7DQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDmtY/op4jmjIfmoIfnmoTlpITnkIYNCiAgICB2aWV3T3BlcmF0aW9uKCkgew0KICAgICAgdGhpcy4kYXhpb3MucG9zdChgL3NjZW5pYy92aWV3T3BlcmF0aW9uLyR7dGhpcy5zY2VuaWMuaWR9YCkudGhlbihyZXMgPT4gew0KICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PT0gMjAwKSB7DQogICAgICAgICAgY29uc29sZS5sb2coIua1j+iniOaMh+agh+W3sue7j+iusOW9lSIpOw0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g5p+l6K+i55So5oi35piv5ZCm5bey57uP5pS26JeP5LqG6L+Z5Liq5pmv54K5DQogICAgc2F2ZVN0YXR1cygpIHsNCiAgICAgIHRoaXMuJGF4aW9zLnBvc3QoYC9zY2VuaWMvc2F2ZVN0YXR1cy8ke3RoaXMuc2NlbmljLmlkfWApLnRoZW4ocmVzID0+IHsNCiAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDIwMCkgew0KICAgICAgICAgIHRoaXMuc2F2ZUJ0bkZsYWcgPSBCb29sZWFuKHJlcy5kYXRhLmRhdGEpOw0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g6K+E5YiGDQogICAgcmF0aW5nQ2hhbmdlKHNjb3JlKSB7DQogICAgICB0aGlzLiRheGlvcy5wb3N0KCcvc2NlbmljUmF0aW5nL3NhdmUnLCB7IHNjZW5pY0lkOiB0aGlzLnNjZW5pYy5pZCwgc2NvcmUgfSkudGhlbihyZXMgPT4gew0KICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PT0gMjAwKSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlcy5kYXRhLm1zZyk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZShyZXMuZGF0YS5tc2cpOw0KICAgICAgICB9DQogICAgICAgIHRoaXMucXVlcnlSYXRpbmdTdGF0dXMoKTsNCiAgICAgICAgdGhpcy5mZXRjaFNjZW5pUmF0aW5nKHRoaXMuc2NlbmljLmlkKTsNCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDlvIDlp4vnmoTml7blgJnvvIzlhYjmn6Xor6LmmK/lkKblt7Lnu4/or4TliIbvvIzlpoLmnpzmsqHmnInor4TliIbvvIzmmL7npLror4TliIbnmoTnu4Tku7YNCiAgICBxdWVyeVJhdGluZ1N0YXR1cygpIHsNCiAgICAgIHRoaXMuJGF4aW9zLnBvc3QoJy9zY2VuaWNSYXRpbmcvcXVlcnlVc2VyJywgeyBzY2VuaWNJZDogdGhpcy5zY2VuaWMuaWQgfSkudGhlbihyZXMgPT4gew0KICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PT0gMjAwKSB7DQogICAgICAgICAgdGhpcy5yYXRpbmdGbGFnID0gcmVzLmRhdGEuZGF0YS5sZW5ndGggIT09IDA7DQogICAgICAgICAgLy8g5aaC5p6c6K+E6L+H5YiG77yM5a2Y5YKo5a+55bqU55qE5YiG5pWw77yM5YGa5pi+56S6DQogICAgICAgICAgaWYgKHRoaXMucmF0aW5nRmxhZykgew0KICAgICAgICAgICAgdGhpcy5teVNjb3JlID0gcmVzLmRhdGEuZGF0YVswXS5zY29yZTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICBoYW5kbGVDbGljayh0YWIsIGV2ZW50KSB7DQogICAgICBpZiAodGFiLmluZGV4ID09PSAnMycpIHsNCiAgICAgICAgdGhpcy5mZXRjaFNjZW5pUmF0aW5nKHRoaXMuc2NlbmljLmlkKTsNCiAgICAgICAgdGhpcy5xdWVyeVJhdGluZ1N0YXR1cygpOw0KICAgICAgfSBlbHNlIGlmICh0YWIuaW5kZXggPT09ICc0Jykgew0KICAgICAgICB0aGlzLmZldGNoU2NlbmljVGlja2V0KHRoaXMuc2NlbmljLmlkKTsNCiAgICAgIH0gZWxzZSBpZiAodGFiLmluZGV4ID09PSAnMicpIHsNCiAgICAgICAgdGhpcy5xdWVyeUxpbmUodGhpcy5zY2VuaWMuaWQpOw0KICAgICAgfQ0KICAgIH0sDQogICAgLy8g6K6w6L295pmv5Yy65LiL6Z2i55qE6Zeo56Wo5L+h5oGvDQogICAgZmV0Y2hTY2VuaWNUaWNrZXQoc2NlbmljSWQpIHsNCiAgICAgIHRoaXMuJGF4aW9zLnBvc3QoJy9zY2VuaWNUaWNrZXQvcXVlcnknLCB7IHNjZW5pY0lkOiBzY2VuaWNJZCB9KS50aGVuKHJlcyA9PiB7DQogICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09PSAyMDApIHsNCiAgICAgICAgICB0aGlzLnNjZW5pY1RpY2tldExpc3QgPSByZXMuZGF0YS5kYXRhOw0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g5p+l6K+i5pmv54K55LiL6Z2i55qE6K+E5YiG5L+h5oGvDQogICAgZmV0Y2hTY2VuaVJhdGluZyhzY2VuaWNJZCkgew0KICAgICAgdGhpcy4kYXhpb3MucG9zdCgnL3NjZW5pY1JhdGluZy9xdWVyeScsIHsgc2NlbmljSWQ6IHNjZW5pY0lkIH0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDIwMCkgew0KICAgICAgICAgIHRoaXMuc2NlbmljUmF0aW5nTGlzdCA9IHJlcy5kYXRhLmRhdGE7DQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDmlLbol4/kuI7mtY/op4jnmoTlpITnkIbmlrnms5UNCiAgICBzdHJEZWFsKHN0cikgew0KICAgICAgaWYgKHN0ciA9PT0gbnVsbCkgew0KICAgICAgICByZXR1cm4gJygwKScNCiAgICAgIH0NCiAgICAgIGNvbnN0IHNhdmVJZHNBcnkgPSBzdHIuc3BsaXQoJywnKTsNCiAgICAgIHJldHVybiAnKCcgKyBzYXZlSWRzQXJ5Lmxlbmd0aCArICcpJzsNCiAgICB9LA0KICAgIHRpbWVBZ28oc2NlbmljKSB7DQogICAgICByZXR1cm4gdGltZUFnbyhzY2VuaWMuY3JlYXRlVGltZSk7DQogICAgfSwNCiAgICBsb2FkSW5mbygpIHsNCiAgICAgIGNvbnN0IGpzb25TY2VuaWNJbmZvID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnc2NlbmljSW5mbycpOw0KICAgICAgdGhpcy5zY2VuaWMgPSBKU09OLnBhcnNlKGpzb25TY2VuaWNJbmZvKTsNCiAgICAgIHRoaXMudmlld09wZXJhdGlvbigpOw0KICAgICAgdGhpcy5zYXZlU3RhdHVzKCk7DQogICAgfSwNCiAgfQ0KfTsNCg=="},{"version":3,"sources":["ScenicDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ScenicDetail.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"item\">\r\n      <div class=\"name\">{{ scenic.name }}</div>\r\n      <img :src=\"scenic.cover\" alt=\"\" srcset=\"\">\r\n      <div>\r\n                <span class=\"address\">\r\n                    <i class=\"el-icon-location\"></i>\r\n                    {{ scenic.address }}\r\n                </span>\r\n      </div>\r\n      <div class=\"info\">\r\n        <span class=\"time\">{{ timeAgo(scenic) }}</span>\r\n        <span class=\"save\">收藏{{ strDeal(scenic.saveIds) }}</span>\r\n        <span class=\"view\">浏览{{ strDeal(scenic.viewIds) }}</span>\r\n      </div>\r\n      <div class=\"extra-info\">\r\n        <span><i class=\"el-icon-school\"></i>{{ scenic.vendorName }}</span>\r\n        <span>{{ scenic.categoryName }}</span>\r\n      </div>\r\n      <div style=\"margin-top: 20px;\">\r\n                <span class=\"save-btn\" @click=\"saveOperation\" v-if=\"!saveBtnFlag\"><i\r\n                    class=\"el-icon-star-off\"></i>立即收藏</span>\r\n        <span class=\"cannel-save-btn\" @click=\"saveOperation\" v-else><i class=\"el-icon-star-on\"></i>取消收藏</span>\r\n      </div>\r\n    </div>\r\n    <div>\r\n      <el-tabs v-model=\"activeName\" @tab-click=\"handleClick\">\r\n        <el-tab-pane label=\"景点详情\" name=\"first\">\r\n          <div v-if=\"scenic.detail === null\">\r\n            <el-empty description=\"该景点暂无介绍\"></el-empty>\r\n          </div>\r\n          <div v-else v-html=\"scenic.detail\"></div>\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"评论\" name=\"second\">\r\n          <Evaluations contentType=\"SCENIC\" :contentId=\"scenic.id\" />\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"景点路线\" name=\"five\">\r\n          <div v-if=\"scenicLineList.length === 0\">\r\n            <el-empty description=\"暂未收录路线\"></el-empty>\r\n          </div>\r\n          <div v-else>\r\n            <el-carousel ref=\"carousel\" height=\"450px\" indicator-position=\"none\" @click.native=\"handleCarouselClick\">\r\n              <el-carousel-item v-for=\"(item, index) in scenicLineList\" :key=\"index\">\r\n                <img :src=\"item.cover\" style=\"border-radius: 5px;height: 100%;width: 100%;object-fit: cover;cursor: pointer;\" alt=\"\" srcset=\"\">\r\n                <div style=\"position: absolute; bottom: 0; left: 0; right: 0; background-color: rgba(0, 0, 0, 0.6); color: aliceblue; padding: 20px; text-align: center;\">\r\n                  <h3 style=\"margin: 0; font-size: 12px;\">{{ item.detail }}</h3>\r\n                </div>\r\n              </el-carousel-item>\r\n            </el-carousel>\r\n          </div>\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"景区评分\" name=\"third\">\r\n          <div>\r\n            <div class=\"rating-info\">\r\n              <div class=\"total-value\">\r\n                <div v-if=\"ratingFlag\">\r\n                  <el-result icon=\"success\" title=\"评分\" subTitle=\"\">\r\n                    <template slot=\"extra\">\r\n                      <span>我的评分&nbsp;{{ myScore }}分</span>\r\n                    </template>\r\n                  </el-result>\r\n                </div>\r\n                <div v-else>\r\n                  <div>点此处进行评分</div>\r\n                  <el-rate @change=\"ratingChange\" v-model=\"scenicRating.score\" show-text>\r\n                  </el-rate>\r\n                </div>\r\n              </div>\r\n              <div class=\"total-value\">\r\n                <el-rate v-model=\"scenic.ratingScore\" disabled show-score text-color=\"#ff9900\"\r\n                         score-template=\"平均{value}分\">\r\n                </el-rate>\r\n              </div>\r\n            </div>\r\n            <div class=\"rating-item\" v-for=\"(rating, index) in scenicRatingList\" :key=\"index\">\r\n              <div>\r\n                <div class=\"info\">\r\n                  <el-avatar :size=\"30\" :src=\"rating.userAvatar\"></el-avatar>\r\n                  <span>{{ rating.userName }}</span>\r\n                </div>\r\n                <div class=\"score\">\r\n                  <el-rate v-model=\"rating.score\" disabled show-score text-color=\"#ff9900\"\r\n                           score-template=\"{value}分\">\r\n                  </el-rate>\r\n                </div>\r\n                <div class=\"time\">\r\n                  <span>评分于&nbsp;{{ rating.createTime }}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </el-tab-pane>\r\n        <el-tab-pane label=\"门票列表\" name=\"four\">\r\n          <div v-if=\"scenicTicketList.length === 0\">\r\n            <el-empty description=\"暂无门票出售\"></el-empty>\r\n          </div>\r\n          <div v-else>\r\n            <div class=\"ticket-item\" v-for=\"(ticket, index) in scenicTicketList\" :key=\"index\">\r\n              <div class=\"detail\">\r\n                {{ ticket.detail }}\r\n              </div>\r\n              <div class=\"info\">\r\n                <span class=\"price\">￥{{ ticket.price }}</span>\r\n                <span>数量{{ ticket.number }}张</span>\r\n                <span class=\"discount\">{{ ticket.discount === null ? '无折扣' : ticket.discount + '折'\r\n                  }}</span>\r\n              </div>\r\n              <div class=\"operation\">\r\n                <span>出票于{{ timeAgo(ticket) }}</span>\r\n                <el-button size=\"mini\" round @click=\"buyTicketDialog(ticket)\">购票</el-button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </el-tab-pane>\r\n      </el-tabs>\r\n    </div>\r\n    <el-dialog :show-close=\"false\" :visible.sync=\"dialogTicketOperaion\" width=\"25%\">\r\n      <div slot=\"title\">\r\n        <p class=\"dialog-title\">在线购票</p>\r\n      </div>\r\n      <div style=\"padding:0 20px;\">\r\n        <el-row>\r\n          <div class=\"ticket-item\">\r\n            <p>*门票相关信息</p>\r\n            <div class=\"detail\">\r\n              {{ ticket.detail }}\r\n            </div>\r\n            <div class=\"info\">\r\n              <span class=\"price\">￥{{ ticket.price }}</span>\r\n              <span>数量{{ ticket.number }}张</span>\r\n              <span class=\"discount\">{{ ticket.discount === null ? '无折扣' : ticket.discount + '折' }}</span>\r\n            </div>\r\n            <div class=\"operation\">\r\n              <span>出票于{{ timeAgo(ticket) }}</span>\r\n            </div>\r\n          </div>\r\n          <div>\r\n            <div>\r\n              <span class=\"dialog-hover\">联系人</span>\r\n              <input class=\"dialog-input\" v-model=\"data.concatPerson\" placeholder=\"输入\" />\r\n            </div>\r\n            <div>\r\n              <span class=\"dialog-hover\">联系电话</span>\r\n              <input class=\"dialog-input\" v-model=\"data.concatPhone\" placeholder=\"输入\" />\r\n            </div>\r\n            <div>\r\n              <p>*购票数量</p>\r\n              <el-input-number v-model=\"data.buyNumber\" :min=\"1\" :max=\"ticket.number\"\r\n                               label=\"描述文字\"></el-input-number>\r\n            </div>\r\n            <div style=\"margin-block: 20px;\" class=\"ticket-item\">\r\n              <div class=\"info\">\r\n                                <span>共选中{{ data.buyNumber }}张票，金额<span class=\"price\">{{ moneyCount(data)\r\n                                  }}元</span></span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </el-row>\r\n      </div>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button size=\"small\" style=\"background-color: rgb(96, 98, 102);color: rgb(247,248,249);border: none;\"\r\n                           class=\"customer\" type=\"info\" @click=\"addOperation()\">确认购票</el-button>\r\n                <el-button class=\"customer\" size=\"small\" style=\"background-color: rgb(211, 241, 241);border: none;\"\r\n                           @click=\"cannel()\">取消</el-button>\r\n            </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { timeAgo } from \"@/utils/data\"\r\nimport Evaluations from \"@/components/Evaluations\"\r\nexport default {\r\n  components: { Evaluations },\r\n  name: \"ScenicDetail\",\r\n  data() {\r\n    return {\r\n      data: { buyNumber: 1 }, // 存储购票相关的信息\r\n      scenic: {},\r\n      ticket: {},\r\n      scenicRating: {},\r\n      myScore: 0,\r\n      scenicRatingList: [],\r\n      scenicTicketList: [],\r\n      scenicLineList: [],\r\n      dialogTicketOperaion: false,\r\n      activeName: 'first',\r\n      ratingFlag: false,\r\n      saveBtnFlag: false,\r\n    }\r\n  },\r\n  created() {\r\n    this.loadInfo();\r\n  },\r\n  methods: {\r\n    // 查询景点路线\r\n    queryLine(id) {\r\n      this.$axios.post('/scenicLine/query', { scenicId: id }).then(res => {\r\n        if (res.data.code === 200) {\r\n          this.scenicLineList = res.data.data;\r\n        }\r\n      })\r\n    },\r\n    // 购票\r\n    addOperation() {\r\n      this.data.ticketId = this.ticket.id;\r\n      this.$axios.post('/scenicTicketOrder/save', this.data).then(res => {\r\n        if (res.data.code === 200) { // 下单成功\r\n          this.$message.success(res.data.msg);\r\n          this.dialogTicketOperaion = false;\r\n          // 跳到对应的门票订单页\r\n          console.log(\"下单了。跳转订单页\");\r\n        } else {\r\n          this.$message.error(res.data.msg);\r\n        }\r\n      })\r\n    },\r\n    // 统计金额\r\n    moneyCount(data) {\r\n      // 可能没有折扣\r\n      const discountTotal = this.ticket.discount === null ? 1 : (this.ticket.discount / 10);\r\n      const total = data.buyNumber * this.ticket.price * discountTotal;\r\n      // 使用 Math.ceil 取整，然后保留两位小数\r\n      return Math.ceil(total * 100) / 100;\r\n    },\r\n    // 取消购票\r\n    cannel() {\r\n      // 关闭购票弹窗\r\n      this.dialogTicketOperaion = false;\r\n      this.data = {};\r\n    },\r\n    buyTicketDialog(ticket) {\r\n      this.ticket = ticket;\r\n      this.dialogTicketOperaion = true;\r\n    },\r\n    // 收藏操作\r\n    saveOperation() {\r\n      this.$axios.post(`/scenic/saveOperation/${this.scenic.id}`).then(res => {\r\n        if (res.data.code === 200) {\r\n          this.$message.success(res.data.msg);\r\n          this.saveStatus();\r\n        }\r\n      })\r\n    },\r\n    // 浏览指标的处理\r\n    viewOperation() {\r\n      this.$axios.post(`/scenic/viewOperation/${this.scenic.id}`).then(res => {\r\n        if (res.data.code === 200) {\r\n          console.log(\"浏览指标已经记录\");\r\n        }\r\n      })\r\n    },\r\n    // 查询用户是否已经收藏了这个景点\r\n    saveStatus() {\r\n      this.$axios.post(`/scenic/saveStatus/${this.scenic.id}`).then(res => {\r\n        if (res.data.code === 200) {\r\n          this.saveBtnFlag = Boolean(res.data.data);\r\n        }\r\n      })\r\n    },\r\n    // 评分\r\n    ratingChange(score) {\r\n      this.$axios.post('/scenicRating/save', { scenicId: this.scenic.id, score }).then(res => {\r\n        if (res.data.code === 200) {\r\n          this.$message.success(res.data.msg);\r\n        } else {\r\n          this.$message(res.data.msg);\r\n        }\r\n        this.queryRatingStatus();\r\n        this.fetchSceniRating(this.scenic.id);\r\n      })\r\n    },\r\n    // 开始的时候，先查询是否已经评分，如果没有评分，显示评分的组件\r\n    queryRatingStatus() {\r\n      this.$axios.post('/scenicRating/queryUser', { scenicId: this.scenic.id }).then(res => {\r\n        if (res.data.code === 200) {\r\n          this.ratingFlag = res.data.data.length !== 0;\r\n          // 如果评过分，存储对应的分数，做显示\r\n          if (this.ratingFlag) {\r\n            this.myScore = res.data.data[0].score;\r\n          }\r\n        }\r\n      })\r\n    },\r\n    handleClick(tab, event) {\r\n      if (tab.index === '3') {\r\n        this.fetchSceniRating(this.scenic.id);\r\n        this.queryRatingStatus();\r\n      } else if (tab.index === '4') {\r\n        this.fetchScenicTicket(this.scenic.id);\r\n      } else if (tab.index === '2') {\r\n        this.queryLine(this.scenic.id);\r\n      }\r\n    },\r\n    // 记载景区下面的门票信息\r\n    fetchScenicTicket(scenicId) {\r\n      this.$axios.post('/scenicTicket/query', { scenicId: scenicId }).then(res => {\r\n        if (res.data.code === 200) {\r\n          this.scenicTicketList = res.data.data;\r\n        }\r\n      })\r\n    },\r\n    // 查询景点下面的评分信息\r\n    fetchSceniRating(scenicId) {\r\n      this.$axios.post('/scenicRating/query', { scenicId: scenicId }).then(res => {\r\n        if (res.data.code === 200) {\r\n          this.scenicRatingList = res.data.data;\r\n        }\r\n      })\r\n    },\r\n    // 收藏与浏览的处理方法\r\n    strDeal(str) {\r\n      if (str === null) {\r\n        return '(0)'\r\n      }\r\n      const saveIdsAry = str.split(',');\r\n      return '(' + saveIdsAry.length + ')';\r\n    },\r\n    timeAgo(scenic) {\r\n      return timeAgo(scenic.createTime);\r\n    },\r\n    loadInfo() {\r\n      const jsonScenicInfo = sessionStorage.getItem('scenicInfo');\r\n      this.scenic = JSON.parse(jsonScenicInfo);\r\n      this.viewOperation();\r\n      this.saveStatus();\r\n    },\r\n  }\r\n};\r\n</script>\r\n<style scoped lang=\"scss\">\r\n.container {\r\n  width: 900px;\r\n  margin: 0 auto;\r\n\r\n  .save-btn,\r\n  .cannel-save-btn {\r\n    display: inline-block;\r\n    font-size: 12px;\r\n    padding: 6px 10px;\r\n    border-radius: 5px;\r\n  }\r\n\r\n  .save-btn {\r\n    background-color: rgb(51, 51, 51);\r\n    color: rgb(250, 250, 250);\r\n  }\r\n\r\n  .save-btn:hover {\r\n    background-color: rgb(31, 31, 31);\r\n  }\r\n\r\n  .cannel-save-btn:hover {\r\n    background-color: rgb(235, 138, 138);\r\n  }\r\n\r\n  .cannel-save-btn {\r\n    background-color: rgb(237, 157, 157);\r\n    color: rgb(250, 250, 250);\r\n  }\r\n\r\n  .rating-info {\r\n    min-height: 200px;\r\n    display: flex;\r\n    justify-content: space-around;\r\n    background-color: rgb(246, 246, 246);\r\n\r\n    .total-value {\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n    }\r\n  }\r\n\r\n  .rating-item {\r\n    margin-block: 20px;\r\n\r\n    .info {\r\n      display: flex;\r\n      justify-content: left;\r\n      align-items: center;\r\n      gap: 5px;\r\n\r\n      span {\r\n        font-size: 14px;\r\n      }\r\n    }\r\n\r\n    .score,\r\n    .time {\r\n      padding: 6px 30px;\r\n    }\r\n\r\n    .time {\r\n      font-size: 12px;\r\n    }\r\n\r\n  }\r\n\r\n  .ticket-item {\r\n    background-color: rgb(246, 246, 246);\r\n    border-radius: 5px;\r\n    padding: 10px;\r\n    box-sizing: border-box;\r\n    margin-bottom: 2px;\r\n\r\n    .detail {\r\n      font-size: 20px;\r\n      font-weight: 800;\r\n      margin-block: 4px;\r\n    }\r\n\r\n    .info {\r\n      font-size: 12px;\r\n      margin-block: 10px;\r\n      display: flex;\r\n      justify-content: left;\r\n      align-items: center;\r\n      gap: 8px;\r\n      color: rgb(83, 82, 82);\r\n\r\n      .price {\r\n        font-size: 18px;\r\n        font-weight: 800;\r\n        color: rgb(236, 118, 54);\r\n      }\r\n    }\r\n\r\n    .operation {\r\n      display: flex;\r\n      justify-content: left;\r\n      align-items: center;\r\n      gap: 8px;\r\n\r\n      span {\r\n        font-size: 12px;\r\n      }\r\n    }\r\n  }\r\n\r\n  .item {\r\n    margin-block: 20px;\r\n    padding: 30px 10px;\r\n    box-sizing: border-box;\r\n    cursor: pointer;\r\n    background-color: rgb(225, 245, 245);\r\n    border-radius: 5px;\r\n\r\n    .extra-info {\r\n      display: flex;\r\n      justify-content: left;\r\n      align-items: center;\r\n      gap: 5px;\r\n      font-size: 12px;\r\n\r\n      span:last-child {\r\n        display: inline-block;\r\n        padding: 3px 6px;\r\n        border-radius: 3px;\r\n        background-color: aliceblue;\r\n        color: rgb(84, 49, 223);\r\n      }\r\n    }\r\n\r\n    img {\r\n      width: 300px;\r\n      min-height: 120px;\r\n      max-height: 140px;\r\n      border-radius: 5px;\r\n    }\r\n\r\n    .address {\r\n      margin-top: 10px;\r\n      display: inline-block;\r\n      width: 100px;\r\n      font-size: 12px;\r\n      overflow: hidden;\r\n      white-space: nowrap;\r\n      text-overflow: ellipsis;\r\n    }\r\n\r\n    .name {\r\n      font-size: 32px;\r\n      font-weight: 800;\r\n      margin-bottom: 20px;\r\n    }\r\n\r\n    .info {\r\n      display: flex;\r\n      justify-content: left;\r\n      gap: 5px;\r\n      margin-block: 6px;\r\n\r\n      span {\r\n        font-size: 12px;\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n</style>"]}]}